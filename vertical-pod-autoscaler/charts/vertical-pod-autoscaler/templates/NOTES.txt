{{- $componentsList := list }}
{{- if .Values.admissionController.enabled }}{{ $componentsList = append $componentsList "admission-controller" }}{{- end }}
{{- if .Values.recommender.enabled }}{{ $componentsList = append $componentsList "recommender" }}{{- end }}
{{- if .Values.updater.enabled }}{{ $componentsList = append $componentsList "updater" }}{{- end }}

Vertical Pod Autoscaler has been installed!

Components deployed:
{{- range $componentsList }}
   ✓ {{ . }}
{{- end }}

Namespace: {{ .Release.Namespace }}

{{- if .Values.admissionController.enabled }}

Webhook Configuration:
{{- if .Values.admissionController.registerWebhook }}
   Mode: Application-managed
   - Webhook registered by: admission-controller application
   - Certificates managed by: User (you must provide the TLS secret)

   ⚠️  IMPORTANT: You must create the TLS secret '{{ include "vertical-pod-autoscaler.admissionController.tls.secretName" . }}'
   The admission controller will only register the webhook once this secret exists.
   If the secret is created after this install, restart the admission controller:

   kubectl rollout restart deployment/{{ include "vertical-pod-autoscaler.admissionController.fullname" . }} -n {{ .Release.Namespace }}
{{- else if .Values.admissionController.certGen.enabled }}
   Mode: Helm-managed (recommended)
   - Webhook registered by: Helm (MutatingWebhookConfiguration)
   - Certificates managed by: certgen job
{{- else if .Values.admissionController.tls.create }}
   Mode: Helm-managed with Helm-generated certificates
   - Webhook registered by: Helm (MutatingWebhookConfiguration)
   - Certificates managed by: Helm (auto-generated)

   ⚠️  WARNING: Helm-generated certificates
   The TLS certificates are generated by Helm and will be regenerated on each
   'helm upgrade', which may cause brief disruptions. For production, consider:
   - Using certGen (admissionController.certGen.enabled: true)
   - Using cert-manager with a custom secret
{{- else }}
   ⚠️  WARNING: No TLS certificate source configured!
   The admission controller may fail to start. Please set one of:
   - admissionController.certGen.enabled: true (recommended)
   - admissionController.tls.create: true
   - admissionController.registerWebhook: true (application-managed)
{{- end }}
{{- end }}

Documentation: https://github.com/kubernetes/autoscaler/tree/master/vertical-pod-autoscaler
