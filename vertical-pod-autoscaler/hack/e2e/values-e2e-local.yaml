# Helm values for local E2E testing
# Used by deploy-for-e2e-locally.sh
fullnameOverride: vpa

# Image settings - will be overridden via --set at install time
# admissionController.image.repository, admissionController.image.tag, etc.

# Pod security context
podSecurityContext:
  runAsNonRoot: true
  runAsUser: 65534

# Component configurations optimized for local KIND cluster
admissionController:
  enabled: false  # Enabled dynamically based on suite
  replicas: 1
  image:
    pullPolicy: Never
  # Disable pod anti-affinity for single-node clusters
  affinity: {}
  podDisruptionBudget:
    enabled: false
  # Use application-managed webhook for e2e testing (cert rotation test requires this)
  registerWebhook: true
  certGen:
    enabled: false
  # Enable certificate reload for e2e rotation test
  extraArgs:
    - --reload-cert
  # Mount certificates with legacy key names (matching gencerts.sh format)
  volumes:
    - name: tls-certs
      secret:
        secretName: vpa-tls-certs
  volumeMounts:
    - name: tls-certs
      mountPath: /etc/tls-certs
      readOnly: true

recommender:
  enabled: false  # Enabled dynamically based on suite
  replicas: 1
  image:
    pullPolicy: Never
  # Disable pod anti-affinity for single-node clusters
  affinity: {}
  podDisruptionBudget:
    enabled: false
  # Disable leader election for single replica
  leaderElection:
    enabled: false

updater:
  enabled: false  # Enabled dynamically based on suite
  replicas: 1
  image:
    pullPolicy: Never
  # Disable pod anti-affinity for single-node clusters
  affinity: {}
  podDisruptionBudget:
    enabled: false
  # Disable leader election for single replica
  leaderElection:
    enabled: false
